(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{47:function(t,e,i){},59:function(t,e,i){"use strict";i(47)},79:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("mt-loadmore",{ref:"loadmore",attrs:{id:"listWrap","top-method":t.loadNew,"bottom-method":t.loadMore,"bottom-all-loaded":t.allLoaded,autoFill:!1}},t._l(t.dataList,(function(e,a){return i("div",{key:a,staticClass:"videoItem"},[i("div",{staticClass:"videoItem-wrap"},[i("div",{staticClass:"videoWrap"},[i("div",{staticClass:"videoCover",on:{click:function(i){return t.playVideo(e)}}},[i("h3",{staticClass:"title"},[t._v(t._s(e.title))]),t._v(" "),i("img",{staticClass:"poster",attrs:{src:e.cover,alt:""}})]),t._v(" "),i("video",{attrs:{width:"100%",height:"200px","webkit-playsinline":"true",playsinline:"true","x-webkit-airplay":"true","x5-video-player-fullscreen":"false"}},[i("source",{attrs:{src:e.mp4_url}})])]),t._v(" "),i("div",{staticClass:"detial",on:{click:function(i){return t.toDetail(e)}}},[i("img",{staticClass:"avort",attrs:{src:e.videoTopic.topic_icons,alt:""}}),t._v(" "),i("span",{staticClass:"span"},[t._v(t._s(e.topicName))]),t._v(" "),i("span",{staticClass:"span"},[t._v(t._s(e.videosource))])])])])})),0)};a._withStripped=!0;var o=i(2),s=i(4),l=i.n(s),r=i(3),n=i.n(r),d={name:"myVideo",data(){return{host_port:"http://"+n.a.dev.host+":"+n.a.dev.servePort,dataList:[],title:"推荐",currentUrl:l.a.videoUrl[this.title],allLoaded:!1}},created:function(){if(console.log(this.$route),0!=this.dataList.length)return;let t=this.$route.params.type?this.$route.params.type:this.title;this.ajaxData({title:t})},watch:{$route:function(t,e){this.title=t.params.type,this.ajaxData({title:this.title})}},methods:{ajaxData:function(t){if(t.loadMore)this.currentUrl=this.transformUrl(this.currentUrl,"loadMore");else if(t.loadNew)this.currentUrl=this.transformUrl(this.currentUrl,"loadNew");else if(this.currentUrl=l.a.videoUrl[t.title],null!=this.$store.state.video_DATA[t.title])return void(this.dataList=this.$store.state.video_DATA[t.title]);o.Indicator.open({text:"加载中...",spinnerType:"snake"}),this.$http.jsonp(this.host_port+"?key=wy&url="+encodeURIComponent(this.currentUrl)).then((e=>{o.Indicator.close();try{let i=(e=JSON.parse(JSON.parse(e.body)))["视频"];if(0==i.length)return void(this.allLoaded=!0);t.loadMore?this.dataList=this.dataList.concat(i):t.loadNew?this.dataList=i.concat(this.dataList):this.dataList=i,this.$store.commit("setData",{type:"video",title:t.title,data:this.dataList}),console.log([t.title,this.currentUrl,this.dataList])}catch(t){console.log(t)}finally{t.loadMore?this.$refs.loadmore.onBottomLoaded():t.loadNew&&this.$refs.loadmore.onTopLoaded()}}),(t=>{console.log(t)}))},loadMore:function(){this.ajaxData({title:this.title,loadMore:!0})},loadNew:function(){this.ajaxData({title:this.title,loadNew:!0})},toDetail:function(t){this.$router.push({name:"VideoDetail",query:{vid:t.vid}})},transformUrl:function(t,e){let i=t.split("?"),a=i[1],o=a.split("&");for(var s=0;s<o.length;s++){let t=o[s].split("=");if("loadNew"==e){if("fn"==t[0]){let e=Number(t[1]);e+=1,t[1]=e}}else if("loadMore"==e&&"offset"==t[0]){let e=Number(t[1]);e+=10,t[1]=e}o[s]=t.join("=")}a=o.join("&"),i[1]=a;let l=i.join("?");return this.currentUrl=l,console.log(l),l},playVideo:function(){let t=t||window.event;t.currentTarget.style.display="none",t.currentTarget.nextElementSibling.play()}}},c=(i(59),i(1)),h=Object(c.a)(d,a,[],!1,null,"b4406e9c",null);h.options.__file="src/components/videos/VideoList.vue";e.default=h.exports}}]);