(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{52:function(t,n,e){},65:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function t(n,e,a){if(n.user.avatar=n.user.avatar?n.user.avatar:"http://img1.cache.netease.com/t/img/default80.png",e)if(null!=n.otherComment&&e){var s=t(n.otherComment,!0,a);a+='<div class="commentItem" >\n                    <div class="user">\n                        <div class="avatarWrap">\n                            <img class="avatar" src="'.concat(n.user.avatar,'" alt="">\n                        </div>\n                        <div class="userInfo">\n                            <p class="name">').concat(n.user.nickname?n.user.nickname:"***",'\n                                <span class="sText fr gray" >').concat(n.vote,'<i class="icon zan_icon"></i></span>\n                            </p>\n                            <p class="other sText">\n                                <span>').concat(n.user.location,"</span>\n                                <span>").concat(n.deviceInfo.deviceName,"</span>\n                                <span>").concat(n.createTime.slice(0,-3),'</span>\n                            </p>\n                        </div>\n                    </div>\n                    <div class="content">\n                        <p>').concat(n.content,'</p>\n                        <div class="box" >').concat(s,"</div>\n                    </div>\n                </div>")}else null==n.otherComment&&e&&(a+='<div class="commentItem" >\n                    <div class="user">\n                        <div class="avatarWrap">\n                            <img class="avatar" src="'.concat(n.user.avatar,'" alt="">\n                        </div>\n                        <div class="userInfo">\n                            <div class="name">\n                                ').concat(n.user.nickname?n.user.nickname:"***",'\n                                <span class="sText fr gray" >').concat(n.vote,'<i class="icon zan_icon"></i></span>\n                            </div>\n                            <div class="other sText">\n                                <span>').concat(n.user.location,"</span>\n                                <span>").concat(n.deviceInfo.deviceName,"</span>\n                                <span>").concat(n.createTime.slice(0,-3),'</span>\n                            </div>\n                        </div>\n                    </div>\n                    <p class="content">').concat(n.content,"</p>\n                </div>"));else a+='<div class="commentItem" >\n                    <div class="user">\n                        <div class="avatarWrap">\n                            <img class="avatar" src="'.concat(n.user.avatar,'" alt="">\n                        </div>\n                        <div class="userInfo">\n                            <p class="name">\n                                ').concat(n.user.nickname?n.user.nickname:"***",'\n                                <span class="sText fr gray" >').concat(n.vote,'<i class="icon zan_icon"></i></span>\n                            </p>\n                            <p class="other sText">\n                                <span>').concat(n.user.location,"</span>\n                                <span>").concat(n.deviceInfo.deviceName,"</span>\n                                <span>").concat(n.createTime.slice(0,-3),'</span>\n                            </p>\n                        </div>\n                    </div>\n                    <p class="content">').concat(n.content,"</p>\n                </div>");return a}},66:function(t,n,e){"use strict";e(52)},82:function(t,n,e){"use strict";e.r(n);var a=function(){var t=this,n=t._self._c;return n("transition",{attrs:{name:"slide"}},[n("div",{attrs:{id:"commentDetailWrap"}},[n("mt-header",{staticStyle:{"z-index":"5"},attrs:{fixed:""}},[n("mt-button",{attrs:{slot:"left",icon:"back"},on:{click:t.goBack},slot:"left"},[t._v("返回")])],1),t._v(" "),n("mt-loadmore",{ref:"loadmore",staticStyle:{"font-size":"0.3rem"},attrs:{"bottom-method":t.loadMore,"bottom-all-loaded":t.allLoaded,autoFill:!1}},[n("div",{staticClass:"commentList",domProps:{innerHTML:t._s(t.html_structure)}})]),t._v(" "),n("div",{staticClass:"commentWrap"},[n("input",{staticClass:"comment-input",attrs:{type:"text",placeholder:"写跟帖"}})])],1)])};a._withStripped=!0;var s=e(3),o=e.n(s),c=e(65),r=e.n(c),i=e(10),l=e.n(i),m={name:"Comment",data:()=>({host_port:o.a.dev.host+":"+o.a.dev.servePort,currentUrl:"",html_structure:"",allLoaded:!1,commentArr:[]}),created:function(){let t=this.$route.query.docid,n=this.$route.query.postid,e=t||n;this.currentUrl="http://comment.api.163.com/api/v1/products/a2869674571f77b5a0867c3d71db5856/threads/"+e+"/app/comments/hotList?offset=0&limit=10",this.ajaxData({})},mounted:function(){setTimeout((function(){document.getElementById("commentDetailWrap").scrollTop=0}),1e3)},watch:{},methods:{ajaxData:function(t){t.loadMore?this.currentUrl=this.transformUrl(this.currentUrl,"loadMore"):t.loadNew&&(this.currentUrl=this.transformUrl(this.currentUrl,"loadNew")),l.a.showLoading(!0),this.$http.jsonp(this.host_port+"/?key=wy&url="+encodeURIComponent(this.currentUrl)).then((t=>{l.a.showLoading(!1);try{let n=(t=JSON.parse(JSON.parse(t.body))).commentIds,e=t.comments;for(let t=0;t<n.length;t++){let a=n[t].split(",");if(a.length>1){let t,n;for(let s=0;s<a.length;s++)s+1<a.length?(t=JSON.parse(JSON.stringify(e[a[s]])),n=JSON.parse(JSON.stringify(e[a[s+1]])),n.otherComment=t):this.commentArr.push(n)}else this.commentArr.push(e[a[0]])}let a="";for(let t=0;t<this.commentArr.length;t++)this.commentArr[t]&&(a=null==this.commentArr[t].otherComment?r()(this.commentArr[t],!1,a):r()(this.commentArr[t],!0,a));console.log([this.currentUrl,this.commentArr]),this.html_structure=a}catch(t){console.log(t)}finally{this.$refs.loadmore.onBottomLoaded(),42212==t.code&&(this.allLoaded=!0)}}),(t=>{console.log(t)}))},loadMore:function(){this.ajaxData({loadMore:!0})},transformUrl:function(t,n){let e=t.split("?"),a=e[1].split("&");for(var s=0;s<a.length;s++){let t=a[s].split("=");if("loadNew"==n){if("fn"==t[0]){let n=Number(t[1]);n+=1,t[1]=n}}else"loadMore"==n&&(t[1]=Number(t[1])+10);a[s]=t.join("=")}e[1]=a.join("&");let o=e.join("?");return this.currentUrl=o,o}}},d=(e(66),e(1)),p=Object(d.a)(m,a,[],!1,null,null,null);n.default=p.exports}}]);